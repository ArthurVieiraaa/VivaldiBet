<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Cassino VIP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background-color: #1a1a1a;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%233a3a3a' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .font-brand { font-family: 'Cinzel', serif; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.6s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

        .btn-gold {
            background: linear-gradient(145deg, #d4af37, #b1882b);
            color: #2b200a; text-shadow: 1px 1px 1px rgba(255, 255, 255, 0.2);
            border: none; border-bottom: 3px solid #8e6d23;
            transition: all 0.2s ease;
        }
        .btn-gold:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4); }
        .btn-gold:active:not(:disabled) { transform: translateY(1px); border-bottom-width: 1px; }
        .btn-gold:disabled { background: #555; color: #888; border-bottom: 3px solid #333; cursor: not-allowed; }

        .game-card {
            background: #2c2c2c;
            border: 1px solid #444;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .game-card:hover {
            transform: translateY(-10px) rotate(2deg);
            box-shadow: 0 15px 30px rgba(0,0,0,0.5), 0 0 20px #d4af3788;
            border-color: #d4af37;
        }
        .game-card .icon { color: #d4af37; text-shadow: 0 0 15px #d4af37; }

        /* Roleta */
        #rouletteWheelWrapper { transform-origin: center center; }
        #rouletteWheel { transition: transform 7s cubic-bezier(0.25, 1, 0.5, 1); }
        #rouletteBall {
            width: 14px; height: 14px; background: radial-gradient(circle at 4px 4px, #ffffff, #d1d5db);
            border-radius: 50%; box-shadow: 0 0 8px rgba(255,255,255,0.8);
            position: absolute; left: calc(50% - 7px); top: calc(50% - 7px);
            /* O transform inicial ser√° definido via JS */
            z-index: 10;
        }
        .bet-option.selected { box-shadow: 0 0 15px #d4af37 inset; border-color: #d4af37; }
        .bet-option { border: 2px solid transparent; transition: all 0.3s; }
        
        /* Ca√ßa-N√≠queis */
        .reels-container {
            background: #111; padding: 20px; border-radius: 10px;
            border: 5px solid; border-image-slice: 1;
            border-image-source: linear-gradient(to right, #b1882b, #d4af37, #b1882b);
            box-shadow: inset 0 0 20px #000;
        }
        .reel { height: 120px; width: 120px; font-size: 80px; }
        .reel-inner { position: absolute; width: 100%; text-align: center; }

        /* Blackjack */
        .playing-card {
            width: 100px; height: 140px; background: white; border-radius: 8px;
            position: absolute; transition: transform 0.5s ease-out;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            background-size: cover;
        }
        .card-back { background-image: url('https://www.transparenttextures.com/patterns/cardboard-flat.png'), linear-gradient(135deg, #c0392b, #8e241c); }
        .playing-card .value { font-family: 'Cinzel', serif; font-size: 20px; }
        
        /* Anima√ß√£o de Vit√≥ria */
        #win-animation {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
        #win-animation.show {
            opacity: 1;
            pointer-events: auto;
        }
        #win-animation-content {
            opacity: 0;
            transform: scale(0.5);
            transition: opacity 0.4s ease-out, transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }
        #win-animation.show #win-animation-content {
             opacity: 1;
             transform: scale(1);
        }
    </style>
</head>
<body class="text-white">

    <!-- BARRA DE NAVEGA√á√ÉO -->
    <nav class="bg-black/50 backdrop-blur-sm p-4 shadow-lg shadow-black/30 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="font-brand text-2xl text-yellow-400">Casino VIP Club</div>
            <div class="flex items-center gap-4">
                <span class="text-lg hidden sm:inline"><i class="fas fa-user mr-2 text-yellow-400"></i>Jogador 1</span>
                <div class="bg-black/50 px-4 py-2 rounded-lg border border-yellow-500/50">
                    <span class="font-bold text-xl text-yellow-400" id="playerBalance">R$ 1000</span>
                </div>
            </div>
        </div>
    </nav>
    
    <div class="max-w-7xl mx-auto p-8">

        <!-- P√ÅGINA: MENU PRINCIPAL -->
        <div id="game-menu" class="page active">
            <h1 class="font-brand text-5xl text-center mb-12 text-yellow-400 drop-shadow-[0_2px_5px_rgba(0,0,0,0.5)]">Selecione um Jogo</h1>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-16">
                <!-- Card Roleta -->
                <div class="game-card rounded-lg p-8 text-center cursor-pointer" data-game="roulette">
                    <div class="icon text-6xl mb-4"><i class="fa-solid fa-life-ring"></i></div>
                    <h2 class="font-brand text-3xl mb-2">Roleta</h2>
                    <p class="text-gray-400">Aposte na sorte. Vermelho, preto ou o seu n√∫mero da sorte?</p>
                </div>
                <!-- Card Ca√ßa-N√≠queis -->
                <div class="game-card rounded-lg p-8 text-center cursor-pointer" data-game="slots">
                    <div class="icon text-6xl mb-4"><i class="fas fa-gem"></i></div>
                    <h2 class="font-brand text-3xl mb-2">Ca√ßa-N√≠queis</h2>
                    <p class="text-gray-400">Alinhe os s√≠mbolos e ganhe pr√©mios incr√≠veis. Gire para ganhar!</p>
                </div>
                <!-- Card Blackjack -->
                <div class="game-card rounded-lg p-8 text-center cursor-pointer" data-game="blackjack">
                    <div class="icon text-6xl mb-4"><i class="fa-solid fa-cards"></i></div>
                    <h2 class="font-brand text-3xl mb-2">Blackjack</h2>
                    <p class="text-gray-400">Ven√ßa a mesa sem ultrapassar 21. Estrat√©gia e sorte!</p>
                </div>
            </div>

            <!-- Gr√°fico de Desempenho -->
            <div class="bg-gray-800/50 rounded-lg p-6 border border-gray-700 shadow-2xl">
                <h2 class="font-brand text-2xl text-center mb-6 text-yellow-400">Seu Desempenho (Hist√≥rico de Saldo)</h2>
                <div class="relative w-full h-64">
                    <canvas id="balanceChart"></canvas>
                </div>
            </div>
        </div>

        <!-- P√ÅGINA: ROLETA -->
        <div id="roulette-game" class="page">
            <button class="back-btn mb-6 text-yellow-400 hover:text-yellow-200"><i class="fas fa-arrow-left mr-2"></i>Voltar ao Menu</button>
            <div class="bg-gray-800/50 rounded-lg p-6 shadow-2xl">
                <h2 class="font-brand text-4xl text-center mb-6 text-yellow-400">Mesa de Roleta</h2>
                 <div class="flex flex-col lg:flex-row gap-8 items-center justify-around">
                    <!-- Roleta e Bola -->
                    <div class="relative w-[350px] h-[350px] flex items-center justify-center" id="rouletteWheelWrapper">
                        <!-- Ponteiro da Roleta (Fixo √† Direita para alinhar com a l√≥gica de 0 graus SVG) -->
                        <div class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-1/2 w-0 h-0 border-t-[10px] border-t-transparent border-b-[10px] border-b-transparent border-r-[15px] border-r-yellow-500 z-20 rotate-180 drop-shadow-lg"></div>
                        
                        <div id="rouletteWheel" class="w-full h-full">
                            <svg id="rouletteWheelSVG" class="w-full h-full"></svg>
                        </div>
                        <div id="rouletteBall"></div>
                        <div class="absolute w-16 h-16 bg-yellow-600 rounded-full border-4 border-yellow-800 shadow-inner z-10"></div>
                    </div>
                    <div>
                        <div class="grid grid-cols-1 gap-2 text-lg">
                            <div id="bet-red" class="bet-option p-4 text-center rounded bg-red-800 cursor-pointer hover:bg-red-700">Vermelho (2x)</div>
                            <div id="bet-black" class="bet-option p-4 text-center rounded bg-gray-900 cursor-pointer hover:bg-gray-800">Preto (2x)</div>
                            <div id="bet-even" class="bet-option p-4 text-center rounded bg-green-900 cursor-pointer hover:bg-green-800">Par (2x)</div>
                            <div id="bet-odd" class="bet-option p-4 text-center rounded bg-green-900 cursor-pointer hover:bg-green-800">√çmpar (2x)</div>
                        </div>
                    </div>
                 </div>
                 <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4">
                    <input type="number" id="rouletteBetAmount" class="bg-black/50 text-white p-3 rounded-lg w-full sm:w-48 text-center text-xl border-2 border-gray-600 focus:border-yellow-400 focus:outline-none" value="50">
                    <button id="spinRouletteBtn" class="w-full sm:w-auto btn-gold font-bold py-3 px-10 rounded-lg text-xl"><i class="fas fa-play mr-2"></i>Girar</button>
                </div>
                <div id="rouletteMessage" class="text-center mt-6 font-semibold text-2xl min-h-[36px]"></div>
            </div>
        </div>

        <!-- P√ÅGINA: CA√áA-N√çQUEIS -->
        <div id="slots-game" class="page">
             <button class="back-btn mb-6 text-yellow-400 hover:text-yellow-200"><i class="fas fa-arrow-left mr-2"></i>Voltar ao Menu</button>
             <div class="bg-gray-800/50 rounded-lg p-6 shadow-2xl flex flex-col items-center">
                <h2 class="font-brand text-4xl text-center mb-2 text-yellow-400">Golden Slots</h2>
                <p class="mb-8 text-gray-400">üíéüíéüíé = 15x | üîîüîîüîî = 10x | üçíüçíüçí = 5x</p>
                <div class="reels-container flex gap-5">
                    <div class="reel overflow-hidden relative"><div class="reel-inner"></div></div>
                    <div class="reel overflow-hidden relative"><div class="reel-inner"></div></div>
                    <div class="reel overflow-hidden relative"><div class="reel-inner"></div></div>
                </div>
                 <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4">
                    <input type="number" id="slotsBetAmount" class="bg-black/50 text-white p-3 rounded-lg w-full sm:w-48 text-center text-xl border-2 border-gray-600 focus:border-yellow-400 focus:outline-none" value="10">
                    <button id="spinSlotsBtn" class="w-full sm:w-auto btn-gold font-bold py-3 px-10 rounded-lg text-xl"><i class="fas fa-play mr-2"></i>Girar</button>
                </div>
                <div id="slotsMessage" class="text-center mt-6 font-semibold text-2xl min-h-[36px]"></div>
             </div>
        </div>

        <!-- P√ÅGINA: BLACKJACK -->
        <div id="blackjack-game" class="page">
            <button class="back-btn mb-6 text-yellow-400 hover:text-yellow-200"><i class="fas fa-arrow-left mr-2"></i>Voltar ao Menu</button>
            <div class="bg-green-900/70 rounded-lg p-6 shadow-2xl border-4 border-yellow-800">
                <div class="relative">
                     <!-- M√£o da Mesa -->
                    <div class="text-center mb-10">
                        <h3 class="font-brand text-2xl mb-2">Mesa (<span id="dealerScore">0</span>)</h3>
                        <div id="dealerHand" class="relative flex justify-center items-center min-h-[150px]"></div>
                    </div>
                    <!-- M√£o do Jogador -->
                    <div class="text-center">
                        <h3 class="font-brand text-2xl mb-2">Sua M√£o (<span id="playerScore">0</span>)</h3>
                        <div id="playerHand" class="relative flex justify-center items-center min-h-[150px]"></div>
                    </div>
                </div>
                <!-- Controles -->
                 <div id="blackjackControls" class="mt-8 flex flex-col items-center justify-center gap-4">
                    <div id="blackjackBettingArea" class="flex flex-col sm:flex-row items-center justify-center gap-4">
                       <input type="number" id="blackjackBetAmount" class="bg-black/50 text-white p-3 rounded-lg w-full sm:w-48 text-center text-xl border-2 border-gray-600 focus:border-yellow-400 focus:outline-none" value="100">
                       <button id="dealBtn" class="w-full sm:w-auto btn-gold font-bold py-3 px-10 rounded-lg text-xl">Apostar</button>
                    </div>
                    <div id="playerActions" class="hidden items-center justify-center gap-4">
                       <button id="hitBtn" class="btn-gold font-bold py-3 px-8 rounded-lg">Pedir Carta</button>
                       <button id="standBtn" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg border-b-4 border-gray-900">Manter</button>
                    </div>
                </div>
                <div id="blackjackMessage" class="text-center mt-6 font-semibold text-2xl min-h-[36px]"></div>
            </div>
        </div>
    </div>
    
    <!-- ANIMA√á√ÉO DE VIT√ìRIA -->
    <div id="win-animation" class="fixed top-0 left-0 w-full h-full flex items-center justify-center bg-black/70 z-50 hidden">
        <div id="win-animation-content" class="text-center">
            <h2 class="font-brand text-6xl md:text-8xl text-yellow-300" style="text-shadow: 0 0 15px #fef08a, 0 0 25px #fef08a;">VIT√ìRIA!</h2>
            <p class="text-4xl md:text-5xl text-white mt-4 font-bold">+<span id="win-amount"></span></p>
        </div>
    </div>

<script>
// --- L√ìGICA GERAL E NAVEGA√á√ÉO ---
const balanceEl = document.getElementById('playerBalance');
const winAnimationEl = document.getElementById('win-animation');
const winAmountEl = document.getElementById('win-amount');
let playerBalance = 1000;

// Vari√°veis para o Gr√°fico
let balanceHistory = [1000];
let balanceLabels = ['0'];
let balanceChart;

function initChart() {
    const ctx = document.getElementById('balanceChart').getContext('2d');
    balanceChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: balanceLabels,
            datasets: [{
                label: 'Saldo (R$)',
                data: balanceHistory,
                borderColor: '#facc15', // Yellow-400
                backgroundColor: 'rgba(250, 204, 21, 0.1)',
                borderWidth: 2,
                tension: 0.3,
                pointRadius: 3,
                pointBackgroundColor: '#facc15',
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    mode: 'index',
                    intersect: false,
                    callbacks: {
                        label: function(context) {
                            return 'R$ ' + context.parsed.y;
                        }
                    }
                }
            },
            scales: {
                y: {
                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                    ticks: { color: '#9ca3af' }
                },
                x: {
                    grid: { display: false },
                    ticks: { display: false }
                }
            }
        }
    });
}

// Inicializar o gr√°fico quando a p√°gina carregar
window.addEventListener('load', initChart);

function showWinningAnimation(amount) {
    winAmountEl.textContent = `R$ ${amount.toFixed(0)}`;
    winAnimationEl.classList.remove('hidden');

    setTimeout(() => { 
         winAnimationEl.classList.add('show');
    }, 20);

    setTimeout(() => {
        winAnimationEl.classList.remove('show');
        setTimeout(() => {
            winAnimationEl.classList.add('hidden');
        }, 500); 
    }, 2500);
}


function updateBalance(newBalance) {
    playerBalance = newBalance;
    balanceEl.textContent = `R$ ${playerBalance.toFixed(0)}`;
    
    // Atualizar Gr√°fico
    balanceHistory.push(newBalance);
    balanceLabels.push(balanceHistory.length.toString());
    if (balanceChart) {
        balanceChart.data.labels = balanceLabels;
        balanceChart.data.datasets[0].data = balanceHistory;
        balanceChart.update();
    }

    if (playerBalance <= 0) {
        setTimeout(() => {
            alert("Voc√™ ficou sem dinheiro! O jogo ser√° reiniciado com R$ 1000.");
            
            // Reiniciar hist√≥rico do gr√°fico
            balanceHistory = [1000];
            balanceLabels = ['0'];
            if(balanceChart) {
                balanceChart.data.labels = balanceLabels;
                balanceChart.data.datasets[0].data = balanceHistory;
                balanceChart.update();
            }
            
            // Chamar updateBalance(1000) vai adicionar o 1000 novamente, mas como limpamos
            // o array acima, o resultado final ser√° [1000, 1000], o que √© aceit√°vel ou
            // podemos apenas atualizar a vari√°vel e o texto manualmente aqui para evitar duplicata.
            // Para simplicidade, vamos deixar o updateBalance lidar com o 1000 inicial.
            // Mas para evitar [1000, 1000], resetamos para vazio antes de chamar updateBalance.
            balanceHistory = [];
            balanceLabels = [];

            updateBalance(1000);
            switchToPage('game-menu');
        }, 500);
    }
}

function switchToPage(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
}

document.querySelectorAll('.game-card').forEach(card => {
    card.addEventListener('click', () => switchToPage(card.dataset.game + '-game'));
});

document.querySelectorAll('.back-btn').forEach(btn => {
    btn.addEventListener('click', () => switchToPage('game-menu'));
});

// --- L√ìGICA DA ROLETA ---
const spinRouletteBtn = document.getElementById('spinRouletteBtn');
const rouletteBetAmountEl = document.getElementById('rouletteBetAmount');
const rouletteMessage = document.getElementById('rouletteMessage');
const rouletteWheel = document.getElementById('rouletteWheel');
const rouletteBall = document.getElementById('rouletteBall');
const rouletteBetOptions = document.querySelectorAll('#roulette-game .bet-option');
let isRouletteSpinning = false;
let selectedRouletteBet = null;

const rouletteNumbers = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
const numberColors = {red: [32, 19, 21, 25, 34, 27, 36, 30, 23, 5, 16, 1, 14, 9, 18, 7, 12, 3], black: [15, 4, 2, 17, 6, 13, 11, 8, 10, 24, 33, 20, 31, 22, 29, 28, 35, 26]};
const numberAngle = 360 / rouletteNumbers.length;
let currentWheelRotation = 0;

// Set initial ball position
rouletteBall.style.transform = `rotate(0deg) translateY(145px) rotate(0deg)`;

function generateRouletteWheelSVG() {
    const wheelSVG = document.getElementById('rouletteWheelSVG');
    wheelSVG.innerHTML = ''; 
    const radius = 170;
    const centerX = 175;
    const centerY = 175;
    let wheelHTML = '';

    rouletteNumbers.forEach((num, index) => {
        const angle = numberAngle * index;
        const color = numberColors.red.includes(num) ? '#b91c1c' : numberColors.black.includes(num) ? '#1f2937' : '#15803d';
        
        // Convert polar to cartesian
        const startAngle = angle - numberAngle / 2;
        const endAngle = angle + numberAngle / 2;
        // Note: in SVG coords, Y grows down.
        const startX = centerX + radius * Math.cos(Math.PI / 180 * startAngle);
        const startY = centerY + radius * Math.sin(Math.PI / 180 * startAngle);
        const endX = centerX + radius * Math.cos(Math.PI / 180 * endAngle);
        const endY = centerY + radius * Math.sin(Math.PI / 180 * endAngle);
        
        wheelHTML += `<path d="M${centerX} ${centerY} L${startX} ${startY} A${radius} ${radius} 0 0 1 ${endX} ${endY} Z" fill="${color}" stroke="#1a1a1a" stroke-width="1"/>`;

        const textAngle = angle;
        const textRadius = radius - 20;
        const textX = centerX + textRadius * Math.cos(Math.PI / 180 * textAngle);
        const textY = centerY + textRadius * Math.sin(Math.PI / 180 * textAngle);
        // Rotate text to align with wedge
        wheelHTML += `<text fill="white" font-size="14" font-weight="bold" x="${textX}" y="${textY}" transform="rotate(${textAngle + 90}, ${textX}, ${textY})" text-anchor="middle" dominant-baseline="middle">${num}</text>`;
    });
    wheelSVG.innerHTML = wheelHTML;
}
generateRouletteWheelSVG();


rouletteBetOptions.forEach(option => {
    option.addEventListener('click', () => {
        if(isRouletteSpinning) return;
        rouletteBetOptions.forEach(o => o.classList.remove('selected'));
        option.classList.add('selected');
        selectedRouletteBet = option.id.replace('bet-', '');
    });
});

spinRouletteBtn.addEventListener('click', () => {
    const betAmount = parseInt(rouletteBetAmountEl.value);
    if (isRouletteSpinning || !selectedRouletteBet || isNaN(betAmount) || betAmount <= 0 || betAmount > playerBalance) {
        rouletteMessage.textContent = betAmount > playerBalance ? "Saldo insuficiente!" : "Aposta inv√°lida!";
        return;
    }

    isRouletteSpinning = true;
    spinRouletteBtn.disabled = true;
    rouletteMessage.textContent = 'Girando...';
    updateBalance(playerBalance - betAmount);
    
    const randomIndex = Math.floor(Math.random() * rouletteNumbers.length);
    const winningNumber = rouletteNumbers[randomIndex];
    
    // We want the winning number to end up at 0 degrees (Right side - 3 o'clock)
    // because that's where index 0 starts in SVG and where our pointer is.
    // targetAngle rotates the wheel so that the chosen index ends up at 0 deg.
    const targetAngle = 360 - (randomIndex * numberAngle);

    currentWheelRotation += (360 * 5) + targetAngle - (currentWheelRotation % 360);
    rouletteWheel.style.transform = `rotate(${currentWheelRotation}deg)`;

    // Ball Animation
    rouletteBall.style.transition = 'transform 0s';
    // Reset ball to start position
    rouletteBall.style.transform = `rotate(0deg) translateY(145px) rotate(0deg)`;
    
    setTimeout(() => {
        rouletteBall.style.transition = 'transform 6.5s cubic-bezier(0.1, 0.7, 0.3, 1)';
        
        // Ball rotates counter to wheel to simulate physics, but ultimately needs to land
        // at the winning slot position.
        // Since the wheel rotates the winning slot to 3 o'clock (Right),
        // The ball MUST land at 3 o'clock (Right).
        // In the CSS transform model with translateY(positive), "Down" is the initial direction.
        // 0 deg -> Down (6 o'clock)
        // -90 deg -> Right (3 o'clock)
        // So we target -90 degrees plus some spins.
        
        const ballSpins = -360 * 8; 
        const landingAngle = -90 + (Math.random() * 4 - 2); // -90 deg is 3 o'clock + jitter
        
        // translateY(135px) puts it on the number ring (radius ~135-145)
        rouletteBall.style.transform = `rotate(${ballSpins + landingAngle}deg) translateY(135px) rotate(${- (ballSpins + landingAngle)}deg)`;
    }, 50);

    setTimeout(() => {
        let win = false;
        let payout = 0;
        const color = numberColors.red.includes(winningNumber) ? 'red' : numberColors.black.includes(winningNumber) ? 'black' : 'green';

        if (selectedRouletteBet === 'red' && color === 'red') { win = true; payout = 2; }
        else if (selectedRouletteBet === 'black' && color === 'black') { win = true; payout = 2; }
        else if (selectedRouletteBet === 'even' && winningNumber !== 0 && winningNumber % 2 === 0) { win = true; payout = 2; }
        else if (selectedRouletteBet === 'odd' && winningNumber % 2 !== 0) { win = true; payout = 2; }

        const winnings = betAmount * payout;
        rouletteMessage.textContent = `N√∫mero: ${winningNumber} (${color})`;
        if (win) {
            updateBalance(playerBalance + winnings);
            rouletteMessage.textContent += ` - Voc√™ ganhou R$ ${winnings}!`;
            showWinningAnimation(winnings);
        } else {
            rouletteMessage.textContent += ' - Voc√™ perdeu.';
        }
        isRouletteSpinning = false;
        spinRouletteBtn.disabled = false;
    }, 7000);
});

// --- L√ìGICA DO CA√áA-N√çQUEIS ---
const spinSlotsBtn = document.getElementById('spinSlotsBtn');
const slotsBetAmountEl = document.getElementById('slotsBetAmount');
const slotsMessage = document.getElementById('slotsMessage');
const reels = document.querySelectorAll('.reel-inner');
const slotSymbols = ['üíé', 'üîî', 'üçí', 'üçã', 'üçâ', '‚≠ê'];
let isSpinningSlots = false;

function setupReels() {
    reels.forEach(reel => {
        reel.innerHTML = '';
        const fragment = document.createDocumentFragment();
        for (let i = 0; i < 30; i++) {
             slotSymbols.forEach(s => {
                const div = document.createElement('div');
                div.textContent = s;
                fragment.appendChild(div);
            });
        }
        reel.appendChild(fragment);
    });
}
setupReels();

spinSlotsBtn.addEventListener('click', () => {
    const betAmount = parseInt(slotsBetAmountEl.value);
    if (isSpinningSlots || isNaN(betAmount) || betAmount <= 0 || betAmount > playerBalance) {
        slotsMessage.textContent = betAmount > playerBalance ? "Saldo insuficiente!" : "Aposta inv√°lida!";
        return;
    }

    isSpinningSlots = true;
    spinSlotsBtn.disabled = true;
    slotsMessage.textContent = 'Girando...';
    updateBalance(playerBalance - betAmount);

    let finalSymbols = [];
    reels.forEach((reel, index) => {
        reel.style.transition = 'none';
        const currentTop = parseFloat(reel.style.top) || 0;
        const symbolHeight = 120;
        const resetTop = (currentTop % (slotSymbols.length * symbolHeight));
        reel.style.top = `${resetTop}px`;

        setTimeout(() => {
            const targetSymbolIndex = Math.floor(Math.random() * slotSymbols.length);
            finalSymbols.push(slotSymbols[targetSymbolIndex]);
            const targetPosition = (20 * slotSymbols.length + targetSymbolIndex) * -symbolHeight;
            
            reel.style.transition = `top ${3 + index * 0.5}s cubic-bezier(0.25, 1, 0.5, 1)`;
            reel.style.top = `${targetPosition}px`;
        }, 100);
    });

    setTimeout(() => {
        let winnings = 0;
        if (finalSymbols[0] === finalSymbols[1] && finalSymbols[1] === finalSymbols[2]) {
            if (finalSymbols[0] === 'üíé') winnings = betAmount * 15;
            else if (finalSymbols[0] === 'üîî') winnings = betAmount * 10;
            else if (finalSymbols[0] === 'üçí') winnings = betAmount * 5;
            else winnings = betAmount * 3;
        }

        if (winnings > 0) {
            slotsMessage.textContent = `Voc√™ ganhou R$ ${winnings}!`;
            updateBalance(playerBalance + winnings);
            showWinningAnimation(winnings);
        } else {
            slotsMessage.textContent = "N√£o foi desta vez!";
        }
        isSpinningSlots = false;
        spinSlotsBtn.disabled = false;
    }, 4500);
});

// --- L√ìGICA DO BLACKJACK ---
const dealBtn = document.getElementById('dealBtn');
const hitBtn = document.getElementById('hitBtn');
const standBtn = document.getElementById('standBtn');
const blackjackBetAmountEl = document.getElementById('blackjackBetAmount');
const blackjackMessage = document.getElementById('blackjackMessage');
const dealerHandEl = document.getElementById('dealerHand');
const playerHandEl = document.getElementById('playerHand');
const dealerScoreEl = document.getElementById('dealerScore');
const playerScoreEl = document.getElementById('playerScore');
const bettingArea = document.getElementById('blackjackBettingArea');
const playerActions = document.getElementById('playerActions');

const suits = {'‚ô•':'red', '‚ô¶':'red', '‚ô£':'black', '‚ô†':'black'}, ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
let deck = [], playerHand = [], dealerHand = [], blackjackBet = 0, isGameOn = false;

function createDeck() { deck = []; for (let suit in suits) for (let rank of ranks) deck.push({ suit, rank, color: suits[suit] }); }
function getCardValue(rank) { if (['J', 'Q', 'K'].includes(rank)) return 10; if (rank === 'A') return 11; return parseInt(rank); }
function calculateScore(hand) { let s = hand.reduce((sum, c) => sum + getCardValue(c.rank), 0), a = hand.filter(c=>c.rank==='A').length; while(s>21&&a>0){s-=10;a--;} return s;}

function createCardEl(card, isHidden = false) {
    const el = document.createElement('div');
    el.className = 'playing-card';
    if(isHidden) {
        el.classList.add('card-back');
    } else {
        el.innerHTML = `<div class="p-2 flex flex-col h-full text-${card.color === 'red' ? 'red-600' : 'black'} justify-between items-center"><span class="value self-start">${card.rank}${card.suit}</span><span class="text-5xl">${card.suit}</span><span class="value self-end rotate-180">${card.rank}${card.suit}</span></div>`;
    }
    return el;
}

function updateHandLayout(handEl) {
    const cards = handEl.children;
    const cardCount = cards.length;
    if (cardCount === 0) return;

    const cardSpacing = 40;
    const handWidth = (cardCount - 1) * cardSpacing;
    
    for (let i = 0; i < cards.length; i++) {
        const cardEl = cards[i];
        const cardOffset = -handWidth / 2 + i * cardSpacing;
        const existingTransform = cardEl.style.transform;
        const rotateMatch = existingTransform.match(/rotate\((.*?)\)/);
        const rotation = rotateMatch ? rotateMatch[0] : `rotate(${Math.random() * 10 - 5}deg)`;
        
        cardEl.style.transform = `translateX(${cardOffset}px) ${rotation}`;
    }
}

async function dealCard(hand, handEl, isHidden = false) {
    const card = deck.pop();
    hand.push(card);
    const cardEl = createCardEl(card, isHidden);
    cardEl.style.transform = 'translateY(-200px) rotate(180deg)';
    handEl.appendChild(cardEl);
    await new Promise(res => setTimeout(res, 50)); // allow card to be added to DOM
}

async function startGame() {
    const bet = parseInt(blackjackBetAmountEl.value);
    if (isNaN(bet) || bet <= 0 || bet > playerBalance) { blackjackMessage.textContent = "Aposta inv√°lida"; return; }
    
    blackjackBet = bet;
    updateBalance(playerBalance - bet);
    isGameOn = true;
    playerHand = []; dealerHand = [];
    playerHandEl.innerHTML = ''; dealerHandEl.innerHTML = '';
    blackjackMessage.textContent = '';
    
    createDeck();
    deck.sort(() => Math.random() - 0.5);

    bettingArea.classList.add('hidden');
    playerActions.classList.remove('hidden');

    await dealCard(playerHand, playerHandEl); updateHandLayout(playerHandEl);
    await dealCard(dealerHand, dealerHandEl, true); updateHandLayout(dealerHandEl);
    await dealCard(playerHand, playerHandEl); updateHandLayout(playerHandEl);
    await dealCard(dealerHand, dealerHandEl); updateHandLayout(dealerHandEl);

    updateScores();
    if(calculateScore(playerHand) === 21) endGame('player');
}

function updateScores(revealDealer = false) {
    playerScoreEl.textContent = calculateScore(playerHand);
    dealerScoreEl.textContent = revealDealer ? calculateScore(dealerHand) : getCardValue(dealerHand[1]?.rank || '0');
}

async function stand() {
    isGameOn = false;
    dealerHandEl.children[0].classList.remove('card-back');
    dealerHandEl.children[0].innerHTML = createCardEl(dealerHand[0]).innerHTML;
    
    let dealerScore = calculateScore(dealerHand);
    updateScores(true);

    while (dealerScore < 17) {
        await new Promise(res => setTimeout(res, 600));
        await dealCard(dealerHand, dealerHandEl);
        updateHandLayout(dealerHandEl);
        dealerScore = calculateScore(dealerHand);
        updateScores(true);
    }
    endGame(dealerScore > 21 || calculateScore(playerHand) > dealerScore ? 'player' : calculateScore(playerHand) < dealerScore ? 'dealer' : 'push');
}

function endGame(winner) {
    isGameOn = false;
    if (winner === 'player') {
        const payout = blackjackBet * 2;
        blackjackMessage.textContent = "Voc√™ ganhou!";
        updateBalance(playerBalance + payout);
        showWinningAnimation(payout);
    } else if (winner === 'dealer') {
        blackjackMessage.textContent = "A mesa ganhou.";
    } else if (winner === 'push') {
        blackjackMessage.textContent = "Empate!";
        updateBalance(playerBalance + blackjackBet);
    } else { // Player busted
        blackjackMessage.textContent = "Voc√™ estourou!";
    }
    bettingArea.classList.remove('hidden');
    playerActions.classList.add('hidden');
}

dealBtn.addEventListener('click', startGame);
hitBtn.addEventListener('click', async () => {
    if(!isGameOn) return;
    await dealCard(playerHand, playerHandEl);
    updateHandLayout(playerHandEl);
    updateScores();
    if (calculateScore(playerHand) > 21) endGame('bust');
});
standBtn.addEventListener('click', () => isGameOn && stand());

</script>

</body>
</html>